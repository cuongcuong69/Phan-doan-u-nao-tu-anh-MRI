2025-11-26 13:38:52,208 [INFO] Using device: cuda
2025-11-26 13:38:52,209 [INFO] --- Starting UNet++ 2D Training ---
2025-11-26 13:38:52,209 [INFO] Loading data...
2025-11-26 13:38:59,238 [INFO] Train samples: 45756, Validation samples: 11439
2025-11-26 13:38:59,239 [INFO] Initializing model, loss, and optimizer...
2025-11-26 13:38:59,480 [INFO] 
--- Epoch 1/30 ---
2025-11-26 14:06:35,046 [INFO] Using device: cuda
2025-11-26 14:06:35,048 [INFO] --- Starting UNet++ 2D Training with Predefined Splits ---
2025-11-26 14:06:35,049 [INFO] Loading data...
2025-11-26 14:06:43,596 [INFO] Train samples: 39990, Validation samples: 8525
2025-11-26 14:06:43,597 [INFO] Initializing model, loss, and optimizer...
2025-11-26 14:06:43,837 [INFO] 
--- Epoch 1/1 ---
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Training Configuration:
[INFO] {
  "data_root": "..\\..\\data\\processed\\2d\\labeled",
  "config_dir": "..\\..\\configs\\splits_2d",
  "ckpt_dir": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d",
  "log_dir": "D:\\Project Advanced CV\\logs\\unetpp_2d",
  "num_epochs": 1,
  "batch_size": 8,
  "learning_rate": 0.001,
  "resize_to": [
    128,
    128
  ],
  "num_workers": 4,
  "resume_from": null
}
[INFO] Using device: cuda
[INFO] Train samples: 39990, Val samples: 8525
[INFO] 
=== Epoch 1/1 ===
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Training Configuration:
[INFO] {
  "data_root": "..\\..\\data\\processed\\2d\\labeled",
  "config_dir": "..\\..\\configs\\splits_2d",
  "ckpt_dir": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d",
  "log_dir": "D:\\Project Advanced CV\\logs\\unetpp_2d",
  "num_epochs": 1,
  "batch_size": 8,
  "learning_rate": 0.001,
  "resize_to": [
    128,
    128
  ],
  "num_workers": 0,
  "resume_from": null
}
[INFO] Using device: cuda
[INFO] Train samples: 39990, Val samples: 8525
[INFO] 
=== Epoch 1/1 ===
[INFO] [TRAIN] TotalLoss=0.2020 | DiceLoss=0.3596 | CELoss=0.0444
[INFO] [VAL] TotalLoss=0.3175 | DiceLoss=0.6108 | CELoss=0.0242
[INFO] [METRICS] Dice=0.8311 | IoU=0.8025 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_001.pth
[INFO] Training Configuration:
[INFO] {
  "data_root": "..\\..\\data\\processed\\2d\\labeled",
  "config_dir": "..\\..\\configs\\splits_2d",
  "ckpt_dir": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d",
  "log_dir": "D:\\Project Advanced CV\\logs\\unetpp_2d",
  "num_epochs": 1,
  "batch_size": 8,
  "learning_rate": 0.001,
  "resize_to": [
    128,
    128
  ],
  "num_workers": 0,
  "resume_from": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d\\checkpoint_epoch_001.pth"
}
[INFO] Using device: cuda
[INFO] Train samples: 39990, Val samples: 8525
[INFO] Loaded checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_001.pth
[INFO] Resumed from D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_001.pth at epoch 1
[INFO] Training Configuration:
[INFO] {
  "data_root": "..\\..\\data\\processed\\2d\\labeled",
  "config_dir": "..\\..\\configs\\splits_2d",
  "ckpt_dir": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d",
  "log_dir": "D:\\Project Advanced CV\\logs\\unetpp_2d",
  "num_epochs": 3,
  "batch_size": 8,
  "learning_rate": 0.001,
  "resize_to": [
    128,
    128
  ],
  "num_workers": 0,
  "resume_from": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d\\checkpoint_epoch_001.pth"
}
[INFO] Using device: cuda
[INFO] Train samples: 39990, Val samples: 8525
[INFO] Loaded checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_001.pth
[INFO] Resumed from D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_001.pth at epoch 1
[INFO] 
=== Epoch 2/3 ===
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Training Configuration:
[INFO] {
  "data_root": "..\\..\\data\\processed\\2d\\labeled",
  "config_dir": "..\\..\\configs\\splits_2d",
  "ckpt_dir": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d",
  "log_dir": "D:\\Project Advanced CV\\logs\\unetpp_2d",
  "num_epochs": 30,
  "batch_size": 8,
  "learning_rate": 0.001,
  "resize_to": [
    128,
    128
  ],
  "num_workers": 0,
  "resume_from": null
}
[INFO] Using device: cuda
[INFO] Train samples: 39990, Val samples: 8525
[INFO] 
=== Epoch 1/30 ===
[INFO] [TRAIN] TotalLoss=0.3979 | DiceLoss=0.3543 | CELoss=0.0437
[INFO] [VAL] TotalLoss=0.6380 | DiceLoss=0.6139 | CELoss=0.0241
[INFO] [METRICS] Dice=0.8328 | IoU=0.8050 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8328, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_001.pth
[INFO] 
=== Epoch 2/30 ===
[INFO] [TRAIN] TotalLoss=0.3081 | DiceLoss=0.2800 | CELoss=0.0281
[INFO] [VAL] TotalLoss=0.6259 | DiceLoss=0.6048 | CELoss=0.0211
[INFO] [METRICS] Dice=0.8618 | IoU=0.8357 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8618, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_002.pth
[INFO] 
=== Epoch 3/30 ===
[INFO] [TRAIN] TotalLoss=0.2872 | DiceLoss=0.2619 | CELoss=0.0253
[INFO] [VAL] TotalLoss=0.6286 | DiceLoss=0.6050 | CELoss=0.0236
[INFO] [METRICS] Dice=0.8670 | IoU=0.8413 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8670, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_003.pth
[INFO] 
=== Epoch 4/30 ===
[INFO] [TRAIN] TotalLoss=0.2730 | DiceLoss=0.2496 | CELoss=0.0234
[INFO] [VAL] TotalLoss=0.6207 | DiceLoss=0.6003 | CELoss=0.0205
[INFO] [METRICS] Dice=0.8515 | IoU=0.8248 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_004.pth
[INFO] 
=== Epoch 5/30 ===
[INFO] [TRAIN] TotalLoss=0.2630 | DiceLoss=0.2405 | CELoss=0.0225
[INFO] [VAL] TotalLoss=0.6166 | DiceLoss=0.5971 | CELoss=0.0195
[INFO] [METRICS] Dice=0.8664 | IoU=0.8401 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_005.pth
[INFO] 
=== Epoch 6/30 ===
[INFO] [TRAIN] TotalLoss=0.2530 | DiceLoss=0.2319 | CELoss=0.0212
[INFO] [VAL] TotalLoss=0.6130 | DiceLoss=0.5940 | CELoss=0.0189
[INFO] [METRICS] Dice=0.8702 | IoU=0.8438 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8702, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_006.pth
[INFO] 
=== Epoch 7/30 ===
[INFO] [TRAIN] TotalLoss=0.2458 | DiceLoss=0.2257 | CELoss=0.0201
[INFO] [VAL] TotalLoss=0.6175 | DiceLoss=0.5973 | CELoss=0.0202
[INFO] [METRICS] Dice=0.8679 | IoU=0.8415 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_007.pth
[INFO] 
=== Epoch 8/30 ===
[INFO] [TRAIN] TotalLoss=0.2368 | DiceLoss=0.2178 | CELoss=0.0190
[INFO] [VAL] TotalLoss=0.6135 | DiceLoss=0.5932 | CELoss=0.0203
[INFO] [METRICS] Dice=0.8735 | IoU=0.8474 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8735, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_008.pth
[INFO] 
=== Epoch 9/30 ===
[INFO] [TRAIN] TotalLoss=0.2279 | DiceLoss=0.2095 | CELoss=0.0185
[INFO] [VAL] TotalLoss=0.4404 | DiceLoss=0.4179 | CELoss=0.0225
[INFO] [METRICS] Dice=0.8759 | IoU=0.8497 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8759, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_009.pth
[INFO] 
=== Epoch 10/30 ===
[INFO] [TRAIN] TotalLoss=0.2224 | DiceLoss=0.2001 | CELoss=0.0223
[INFO] [VAL] TotalLoss=0.4595 | DiceLoss=0.4287 | CELoss=0.0309
[INFO] [METRICS] Dice=0.8730 | IoU=0.8484 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_010.pth
[INFO] 
=== Epoch 11/30 ===
[INFO] [TRAIN] TotalLoss=0.2137 | DiceLoss=0.1931 | CELoss=0.0206
[INFO] [VAL] TotalLoss=0.4500 | DiceLoss=0.4250 | CELoss=0.0250
[INFO] [METRICS] Dice=0.8748 | IoU=0.8486 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_011.pth
[INFO] 
=== Epoch 12/30 ===
[INFO] [TRAIN] TotalLoss=0.2096 | DiceLoss=0.1893 | CELoss=0.0203
[INFO] [VAL] TotalLoss=0.4455 | DiceLoss=0.4216 | CELoss=0.0238
[INFO] [METRICS] Dice=0.8789 | IoU=0.8527 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8789, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_012.pth
[INFO] 
=== Epoch 13/30 ===
[INFO] [TRAIN] TotalLoss=0.2060 | DiceLoss=0.1864 | CELoss=0.0196
[INFO] [VAL] TotalLoss=0.4370 | DiceLoss=0.4146 | CELoss=0.0223
[INFO] [METRICS] Dice=0.8775 | IoU=0.8516 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_013.pth
[INFO] 
=== Epoch 14/30 ===
[INFO] [TRAIN] TotalLoss=0.1985 | DiceLoss=0.1799 | CELoss=0.0185
[INFO] [VAL] TotalLoss=0.4466 | DiceLoss=0.4250 | CELoss=0.0216
[INFO] [METRICS] Dice=0.8712 | IoU=0.8451 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_014.pth
[INFO] 
=== Epoch 15/30 ===
[INFO] [TRAIN] TotalLoss=0.1993 | DiceLoss=0.1804 | CELoss=0.0189
[INFO] [VAL] TotalLoss=0.4515 | DiceLoss=0.4247 | CELoss=0.0268
[INFO] [METRICS] Dice=0.8688 | IoU=0.8425 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_015.pth
[INFO] 
=== Epoch 16/30 ===
[INFO] [TRAIN] TotalLoss=0.1944 | DiceLoss=0.1767 | CELoss=0.0177
[INFO] [VAL] TotalLoss=0.4419 | DiceLoss=0.4185 | CELoss=0.0234
[INFO] [METRICS] Dice=0.8772 | IoU=0.8511 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_016.pth
[INFO] 
=== Epoch 17/30 ===
[INFO] [TRAIN] TotalLoss=0.1877 | DiceLoss=0.1709 | CELoss=0.0168
[INFO] [VAL] TotalLoss=0.4524 | DiceLoss=0.4308 | CELoss=0.0216
[INFO] [METRICS] Dice=0.8684 | IoU=0.8419 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_017.pth
[INFO] 
=== Epoch 18/30 ===
[INFO] [TRAIN] TotalLoss=0.1835 | DiceLoss=0.1674 | CELoss=0.0161
[INFO] [VAL] TotalLoss=0.4452 | DiceLoss=0.4237 | CELoss=0.0215
[INFO] [METRICS] Dice=0.8812 | IoU=0.8553 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8812, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_018.pth
[INFO] 
=== Epoch 19/30 ===
[INFO] [TRAIN] TotalLoss=0.1814 | DiceLoss=0.1654 | CELoss=0.0160
[INFO] [VAL] TotalLoss=0.4385 | DiceLoss=0.4171 | CELoss=0.0214
[INFO] [METRICS] Dice=0.8818 | IoU=0.8557 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8818, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_019.pth
[INFO] 
=== Epoch 20/30 ===
[INFO] [TRAIN] TotalLoss=0.1794 | DiceLoss=0.1630 | CELoss=0.0163
[INFO] [VAL] TotalLoss=0.2999 | DiceLoss=0.2740 | CELoss=0.0259
[INFO] [METRICS] Dice=0.8821 | IoU=0.8563 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8821, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_020.pth
[INFO] 
=== Epoch 21/30 ===
[INFO] [TRAIN] TotalLoss=0.1631 | DiceLoss=0.1458 | CELoss=0.0173
[INFO] [VAL] TotalLoss=0.2793 | DiceLoss=0.2528 | CELoss=0.0264
[INFO] [METRICS] Dice=0.8804 | IoU=0.8545 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_021.pth
[INFO] 
=== Epoch 22/30 ===
[INFO] [TRAIN] TotalLoss=0.1597 | DiceLoss=0.1431 | CELoss=0.0165
[INFO] [VAL] TotalLoss=0.2718 | DiceLoss=0.2435 | CELoss=0.0283
[INFO] [METRICS] Dice=0.8833 | IoU=0.8577 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8833, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_022.pth
[INFO] 
=== Epoch 23/30 ===
[INFO] [TRAIN] TotalLoss=0.1565 | DiceLoss=0.1405 | CELoss=0.0160
[INFO] [VAL] TotalLoss=0.2856 | DiceLoss=0.2606 | CELoss=0.0250
[INFO] [METRICS] Dice=0.8825 | IoU=0.8566 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_023.pth
[INFO] 
=== Epoch 24/30 ===
[INFO] [TRAIN] TotalLoss=0.1532 | DiceLoss=0.1377 | CELoss=0.0155
[INFO] [VAL] TotalLoss=0.2783 | DiceLoss=0.2526 | CELoss=0.0256
[INFO] [METRICS] Dice=0.8811 | IoU=0.8547 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_024.pth
[INFO] 
=== Epoch 25/30 ===
[INFO] [TRAIN] TotalLoss=0.1530 | DiceLoss=0.1375 | CELoss=0.0155
[INFO] [VAL] TotalLoss=0.2741 | DiceLoss=0.2484 | CELoss=0.0257
[INFO] [METRICS] Dice=0.8835 | IoU=0.8575 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] New best Dice: 0.8835, saved to D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_025.pth
[INFO] 
=== Epoch 26/30 ===
[INFO] [TRAIN] TotalLoss=0.1506 | DiceLoss=0.1356 | CELoss=0.0150
[INFO] [VAL] TotalLoss=0.2744 | DiceLoss=0.2488 | CELoss=0.0256
[INFO] [METRICS] Dice=0.8818 | IoU=0.8557 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_026.pth
[INFO] 
=== Epoch 27/30 ===
[INFO] [TRAIN] TotalLoss=0.1518 | DiceLoss=0.1370 | CELoss=0.0148
[INFO] [VAL] TotalLoss=0.2924 | DiceLoss=0.2683 | CELoss=0.0241
[INFO] [METRICS] Dice=0.8790 | IoU=0.8527 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_027.pth
[INFO] 
=== Epoch 28/30 ===
[INFO] [TRAIN] TotalLoss=0.1480 | DiceLoss=0.1333 | CELoss=0.0148
[INFO] [VAL] TotalLoss=0.3107 | DiceLoss=0.2875 | CELoss=0.0232
[INFO] [METRICS] Dice=0.8816 | IoU=0.8556 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_028.pth
[INFO] 
=== Epoch 29/30 ===
[INFO] [TRAIN] TotalLoss=0.1468 | DiceLoss=0.1322 | CELoss=0.0146
[INFO] [VAL] TotalLoss=0.2797 | DiceLoss=0.2538 | CELoss=0.0259
[INFO] [METRICS] Dice=0.8801 | IoU=0.8540 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_029.pth
[INFO] 
=== Epoch 30/30 ===
[INFO] [TRAIN] TotalLoss=0.1481 | DiceLoss=0.1335 | CELoss=0.0146
[INFO] [VAL] TotalLoss=0.2870 | DiceLoss=0.2618 | CELoss=0.0252
[INFO] [METRICS] Dice=0.8809 | IoU=0.8548 | ASD=inf | HD95=inf
[INFO] Saved checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\checkpoint_epoch_030.pth
[INFO] Train samples: 39990, Val samples: 8525
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Loaded checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Loaded checkpoint: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Evaluation results will be saved in: D:\Project Advanced CV\logs\unetpp_2d\evaluation_3d_results
[INFO] Using device for evaluation: cuda
[INFO] Found and grouped data for 0 cases in the test set.
[INFO] Loaded best model from epoch 24 with Dice: 0.8835
[WARNING] No test cases found to evaluate.
[WARNING] Evaluation DataFrame 'evaluation_df_3d' is not available. Skipping summary.
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Evaluation results will be saved in: D:\Project Advanced CV\logs\unetpp_2d\evaluation_3d_results
[INFO] Using device for evaluation: cuda
[INFO] Found and grouped data for 0 cases in the test set.
[INFO] Loaded best model from epoch 24 with Dice: 0.8835
[WARNING] No test cases found to evaluate.
[WARNING] Evaluation DataFrame 'evaluation_df_3d' is not available. Skipping summary.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Training Configuration:
[INFO] {
  "data_root": "..\\..\\data\\processed\\2d\\labeled",
  "config_dir": "..\\..\\configs\\splits_2d",
  "ckpt_dir": "D:\\Project Advanced CV\\checkpoints\\unetpp_2d",
  "log_dir": "D:\\Project Advanced CV\\logs\\unetpp_2d",
  "num_epochs": 30,
  "batch_size": 8,
  "learning_rate": 0.001,
  "resize_to": [
    128,
    128
  ],
  "num_workers": 0,
  "resume_from": null
}
[INFO] Using device: cuda
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Bắt đầu inference trên 8680 lát cắt từ tập test...
[INFO] Hoàn thành inference. Đang xếp chồng các lát cắt và tính toán metric 3D...
[INFO] 
--- KẾT QUẢ ĐÁNH GIÁ TRÊN TẬP TEST ---
[INFO] 
--- CÁC CHỈ SỐ TRUNG BÌNH ---
[INFO] Đã lưu kết quả chi tiết vào: D:\Project Advanced CV\logs\unetpp_2d\test_set_3d_metrics.csv
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Bắt đầu inference trên 8680 lát cắt từ tập test...
[INFO] Hoàn thành inference. Đang xếp chồng các lát cắt và tính toán metric 3D...
[INFO] 
--- KẾT QUẢ ĐÁNH GIÁ CHI TIẾT TRÊN TẬP TEST ---
[INFO] 
--- CÁC CHỈ SỐ TRUNG BÌNH TRÊN TẬP TEST ---
[INFO] Đã lưu kết quả chi tiết vào: D:\Project Advanced CV\logs\unetpp_2d\test_set_3d_metrics_detailed.csv
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Các lớp có trong Ground Truth mask: [0 2]
[INFO] Các lớp có trong Prediction mask: [0 2]
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Bắt đầu inference trên 8680 lát cắt từ tập test với resize (194, 194)...
[ERROR] Lỗi khi chạy evaluation: Sizes of tensors must match except in dimension 1. Expected size 97 but got size 96 for tensor number 1 in the list.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth
[INFO] Bắt đầu inference trên 8680 lát cắt từ tập test...
[INFO] Logger initialized. Log file: D:\Project Advanced CV\logs\unetpp_2d\training_log.txt
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
[INFO] Đang tải model từ: D:\Project Advanced CV\checkpoints\unetpp_2d\best_checkpoint.pth để hiển thị.
